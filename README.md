# Ki

![SCREENSHOT](https://raw.githubusercontent.com/twobob/Ki/master/2ColumnScreenshot.JPG "Screenshot of example implementation")

__Create a searchable image tag website using Python and Elasticlunr.js.__

This project uses a local BLIP-2 captioning model to automatically tag your images, generates thumbnails, and provides a web interface to search them.

## How to Use

1.  **Install Dependencies:**
    Ensure you have Python installed. Then, install the necessary libraries. While specific versions may vary, you'll typically need:
    ```bash
    pip install Pillow transformers torch torchvision torchaudio spacy
    python -m spacy download en_core_web_sm 
    ```
    (Note: `torch` installation can vary based on your system and CUDA availability. Refer to the official PyTorch website for specific instructions if needed.)

2.  **Process Your Images:**
    Navigate to the repository directory and run the main pipeline script, providing the path to your image folder:
    ```bash
    python run_pipeline.py PATH_TO_YOUR_IMAGES
    ```
    This script will:
    *   Scan the `PATH_TO_YOUR_IMAGES` directory for JPG files.
    *   Generate descriptive tags for each image using a local BLIP-2 model.
    *   Create thumbnails for each image and store them in the `img/thumbs/` directory. An optional watermark from `img/overlay/watermark.png` may be applied if `make_thumbs.py` (called by the pipeline) is configured for it.
    *   Compile all tag information into `data.json`, which is used by the search interface.

3.  **Run the Web Server:**
    Once your images are processed and `data.json` is generated, start the local web server:
    ```bash
    python serve.py
    ```
    (On Linux/macOS, you might need to use `python3 serve.py`)

    Then, open your web browser and go to `http://localhost:8000` (or the port specified by `serve.py`) to view and search your images.

## Project Structure Highlights
-   `index.html`: The main page for the image search.
-   `app.js`: Handles the client-side logic, including Elasticlunr.js setup and search functionality.
-   `data.json`: Contains the image tags and metadata for the search index (generated by `run_pipeline.py`).
-   `img/thumbs/`: Directory where thumbnails are stored.
-   `run_pipeline.py`: The main script to process your images (tagging and thumbnail generation).
-   `make_thumbs.py`: Script for generating thumbnails, likely called by `run_pipeline.py`.
-   `serve.py`: A simple Python HTTP server to run the website locally.

## TODO/MAYBES:
*   Make the partial rendering loop stop when you click a result before it is finished.
*   Add transactional folders (e.g., IN, PROCESSED, ERROR) for more efficient content addition.
*   Check EXIF/File attributes for "Time Created" to compare against a "last sync" date for incremental updates.
*   Add a script to search network drives for images.
*   Conduct thorough testing, including corner cases.

